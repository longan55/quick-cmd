# QuickCmd 界面架构分析

## 整体架构概览

QuickCmd 是一个命令管理工具，采用 Vue 3 框架构建，使用了 Composition API。应用采用了组件化的设计模式，将界面拆分为多个独立的组件，通过父子组件通信实现数据流转和交互。

## 组件结构

### 1. 根组件：CommandManager.vue

`CommandManager.vue` 是整个应用的主组件，负责：
- 管理全局状态
- 组织布局结构
- 协调子组件通信
- 处理与后端 API 的交互

**主要子组件：**
- `TopMenuBar` - 顶部菜单栏
- `Sidebar` - 左侧边栏
- `MainContent` - 主内容区域
- `Dialogs` - 对话框组件（设置、关于等）

### 2. 布局组件

#### 2.1 TopMenuBar.vue

**功能：**
- 显示顶部菜单栏
- 提供"设置"和"关于"按钮
- 触发相应的模态框

**结构：**
- 简单的水平布局，包含两个按钮

#### 2.2 Sidebar.vue

**功能：**
- 提供搜索功能
- 系统类型筛选（Windows/Linux/Mac）
- 菜单类型切换（标签/集合/指令）
- 排序选项
- 显示对应分类的列表（标签列表、集合列表、指令列表）

**结构：**
- 顶部：搜索框、系统类型选择器
- 中部：菜单类型切换器、排序选项
- 底部：对应分类的菜单列表

#### 2.3 MainContent.vue

**功能：**
- 根据选择的菜单类型显示不同内容
- 提供新增/编辑/删除功能
- 显示命令列表、标签列表或集合列表
- 实现命令复制功能

**结构：**
- 新增界面（指令/集合/标签）
- 查询界面（命令列表/标签列表/集合列表）

## 数据流

### 数据流向

1. **状态管理**：所有核心数据（命令、标签、集合等）都存储在 `CommandManager.vue` 中
2. **数据传递**：通过 props 将数据传递给子组件
3. **事件通信**：子组件通过 emit 事件与父组件通信，触发状态更新
4. **API 调用**：`CommandManager.vue` 负责与后端 API 交互，获取和更新数据

### 主要数据结构

#### 命令 (Command)
```javascript
{
  id: String,           // 唯一标识符
  name: String,         // 命令名称
  content: String,      // 命令内容
  description: String,  // 命令描述
  tags: Array<String>,  // 关联的标签ID
  collections: Array<String>, // 关联的集合ID
  sortValue: Number,    // 排序值
  copyCount: Number,    // 复制次数
  systemType: Array<String> // 适用系统类型
}
```

#### 标签 (Tag)
```javascript
{
  id: String,           // 唯一标识符
  name: String,         // 标签名称
  description: String,  // 标签描述
  sortValue: Number     // 排序值
}
```

#### 集合 (Collection)
```javascript
{
  id: String,           // 唯一标识符
  name: String,         // 集合名称
  description: String,  // 集合描述
  sortValue: Number     // 排序值
}
```

## 交互流程

### 1. 命令管理流程

1. **查看命令**：
   - 用户在侧边栏选择菜单类型（标签/集合/指令）
   - 选择具体的标签、集合或指令分类
   - 主内容区域显示对应的命令列表

2. **新增命令**：
   - 点击"新增命令"按钮
   - 填写命令表单（名称、内容、描述、标签、集合、适用系统）
   - 保存命令，表单数据通过事件传递给父组件
   - 父组件添加命令到列表并可选择保存到后端

3. **编辑/删除命令**：
   - 在命令列表中点击"编辑"或"删除"按钮
   - 编辑：打开编辑表单（当前代码中未完全实现）
   - 删除：弹出确认对话框，确认后从列表中移除

4. **复制命令**：
   - 点击命令列表中的"复制"按钮
   - 命令内容被复制到剪贴板
   - 显示复制成功提示

### 2. 标签和集合管理流程

与命令管理类似，但针对标签和集合进行操作：
- 查看标签/集合列表
- 新增标签/集合
- 编辑/删除标签/集合

### 3. 筛选和排序流程

1. **系统类型筛选**：
   - 在侧边栏选择系统类型（Windows/Linux/Mac）
   - 命令列表根据选择的系统类型进行过滤

2. **搜索**：
   - 在侧边栏搜索框输入关键词
   - 命令列表根据关键词进行过滤（匹配名称、内容、描述等）

3. **排序**：
   - 打开排序下拉框
   - 选择排序字段（时间、名称、复制次数等）
   - 切换排序方向（升序/降序）
   - 命令列表根据排序规则重新排序

## API 交互

应用通过 WailsJS 与后端 Go 服务进行交互，主要 API 包括：
- `GetMenuItems()` - 获取菜单项
- `GetCommands()` - 获取所有命令
- `GetTags()` - 获取所有标签
- `GetCollections()` - 获取所有集合
- `GetCommandsByTagID(tagId)` - 根据标签ID获取命令
- `GetCommandsByCollectionID(collectionId)` - 根据集合ID获取命令
- `GetStatus()` - 获取系统状态

## 响应式设计

应用支持基本的响应式布局：
- 在小屏幕设备上（max-width: 768px），内容容器从水平布局变为垂直布局
- 按钮组在小屏幕上垂直排列
- 表单元素和选择器在小屏幕上居中显示

## 总结

QuickCmd 采用了清晰的组件化架构，通过 Vue 3 的 Composition API 实现了状态管理和组件通信。应用结构层次分明，数据流清晰，交互逻辑完整，为用户提供了一个直观、高效的命令管理工具。